---
- name: Configure dotfiles
  hosts: localhost
  connection: local
  gather_facts: yes
  vars_files:
    - ../group_vars/all.yml

  vars:
    skip_confirmation: false

  tasks:
    - name: Warning message
      debug:
        msg: "This may overwrite existing setting files in your home directory."
      when: not skip_confirmation

    - name: Confirm before proceeding
      pause:
        prompt: "Are you sure you want to continue? (yes/no)"
      register: confirm
      when: not skip_confirmation

    - name: Abort if not confirmed
      meta: end_play
      when:
        - not skip_confirmation
        - confirm.user_input | default('no') | lower not in ['yes', 'y']

    - name: Update Dotfiles repository
      include_tasks: ../tasks/update-dotfiles.yml

    - name: Initialize directory structure
      include_tasks: ../tasks/init-dirs.yml

    - name: Setup zsh configuration
      include_tasks: ../tasks/zsh.yml

    - name: Setup vim configuration
      include_tasks: ../tasks/vim.yml

    - name: Configure Ghostty terminal
      include_tasks: ../tasks/ghostty.yml

    - name: Setup private dotfiles
      include_tasks: ../tasks/private.yml

    - name: Configure git
      include_tasks: ../tasks/git.yml
